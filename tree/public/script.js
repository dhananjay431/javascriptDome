//console.log(JSON.stringify(tree, null, " "));

angular.module('todoApp', ['ngResource'])
  .controller('TodoListController', function($resource) {
    var todoList = this;
    
	//$resource(url, [paramDefaults], [actions], options);
	/*
	var x=$resource("/db",{},{ 'Data':    {method:'GET',isArray:true}});
	*/

	//todoList.treeDataOfData=[{"parentid":"578db77ec19cc73dbcbd1970","id":"578db77fc19cc73dbcbd1b3f","title":"Masthead","$$hashKey":"object:887"},{"parentid":"578db77ec19cc73dbcbd1970","id":"578db77fc19cc73dbcbd1b45","title":"Statistics","$$hashKey":"object:888"},{"parentid":"578db77ec19cc73dbcbd1970","id":"578db77fc19cc73dbcbd1b4b","title":"Curia","children":[{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea659","title":"Archdiocesan Offices and Directors","$$hashKey":"object:898"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea755","title":"Former Archbishops","$$hashKey":"object:899"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea756","title":"Vicar General","$$hashKey":"object:900"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea757","title":"Pastoral Center","children":[{"parentid":"578db816c19cc73dbcbea757","id":"578db850c19cc73dbcbf4797","title":"Vice Chancellor","$$hashKey":"object:960"},{"parentid":"578db816c19cc73dbcbea757","id":"578db863c19cc73dbcbf7c6a","title":"Chancellor/Chief Operating Officer","$$hashKey":"object:961"},{"parentid":"578db816c19cc73dbcbea757","id":"578db872c19cc73dbcbfa62e","title":"Vice Chancellor for Administration","$$hashKey":"object:962"}],"$$hashKey":"object:901"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea759","title":"Secretary to Archbishop Roger L. Schwietz, O.M.I.","$$hashKey":"object:902"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea75a","title":"Stewardship/Development Office","$$hashKey":"object:903"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea75b","title":"Tribunal","children":[{"parentid":"578db816c19cc73dbcbea75b","id":"578db816c19cc73dbcbea75c","title":"Defender of the Bond","$$hashKey":"object:963"},{"parentid":"578db816c19cc73dbcbea75b","id":"578db816c19cc73dbcbea75d","title":"Notaries","$$hashKey":"object:964"},{"parentid":"578db816c19cc73dbcbea75b","id":"578db83dc19cc73dbcbf14b5","title":"Judicial Vicar","$$hashKey":"object:965"},{"parentid":"578db816c19cc73dbcbea75b","id":"578db848c19cc73dbcbf32a3","title":"Judge","$$hashKey":"object:966"}],"$$hashKey":"object:904"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea75e","title":"Diocesan Consultors","$$hashKey":"object:905"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea75f","title":"Apostleship of the Sea","$$hashKey":"object:906"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea760","title":"Archdiocesan Newspaper","$$hashKey":"object:907"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea761","title":"Magadan Mission","$$hashKey":"object:908"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea762","title":"Campaign for Human Development","$$hashKey":"object:909"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea763","title":"Catholic Social Services","children":[{"parentid":"578db816c19cc73dbcbea763","id":"578db816c19cc73dbcbea764","title":"Board Members","$$hashKey":"object:967"},{"parentid":"578db816c19cc73dbcbea763","id":"578db867c19cc73dbcbf87a8","title":"Ex Officio","$$hashKey":"object:968"},{"parentid":"578db816c19cc73dbcbea763","id":"578db867c19cc73dbcbf87a9","title":"Emeritus Board Member","$$hashKey":"object:969"}],"$$hashKey":"object:910"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea766","title":"Korean Ministry","$$hashKey":"object:911"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea767","title":"Native Ministry","$$hashKey":"object:912"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea768","title":"Office of Finance","$$hashKey":"object:913"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea769","title":"Permanent Diaconate","$$hashKey":"object:914"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea76a","title":"Retreats","$$hashKey":"object:915"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea76c","title":"Victim Assistance Coordinator","$$hashKey":"object:916"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db816c19cc73dbcbea76d","title":"Vocations","$$hashKey":"object:917"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db817c19cc73dbcbea7f3","title":"Propagation of the Faith","$$hashKey":"object:918"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db83dc19cc73dbcbf14b6","title":"Hispanic Ministry","$$hashKey":"object:919"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db850c19cc73dbcbf4768","title":"Director of Catechetical Support Study Project","$$hashKey":"object:920"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db850c19cc73dbcbf4798","title":"Catholic Relief Services","$$hashKey":"object:921"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db863c19cc73dbcbf7c6b","title":"Chief Operating Officer/Chancellor","$$hashKey":"object:922"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db863c19cc73dbcbf7ccc","title":"Director of Seminarians","$$hashKey":"object:923"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db866c19cc73dbcbf872d","title":"Vicar for Clergy","$$hashKey":"object:924"},{"parentid":"578db77fc19cc73dbcbd1b4b","id":"578db871c19cc73dbcbfa502","title":"Director of Faith Formation","$$hashKey":"object:925"}],"$$hashKey":"object:889"},{"parentid":"578db77ec19cc73dbcbd1970","id":"578db77fc19cc73dbcbd1b51","title":"Clergy, Parish, Missions","children":[{"parentid":"578db77fc19cc73dbcbd1b51","id":"578db780c19cc73dbcbd1b99","title":"OUTSIDE THE CITY OF ANCHORAGE","children":[{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69d9","title":"Cordova, Valdez-Cordova Co.","children":[{"parentid":"578db801c19cc73dbcbe69d9","id":"578db780c19cc73dbcbd1d17","title":"St. Joseph","$$hashKey":"object:997"}],"$$hashKey":"object:946"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69da","title":"Dillingham, Dillingham Co.","children":[{"parentid":"578db801c19cc73dbcbe69da","id":"578db780c19cc73dbcbd1d18","title":"Holy Rosary","children":[{"parentid":"578db780c19cc73dbcbd1d18","id":"578db782c19cc73dbcbd2082","title":"St. Theresa","$$hashKey":"object:1041"}],"$$hashKey":"object:1000"}],"$$hashKey":"object:947"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69db","title":"Eagle River, Anchorage Borough","children":[{"parentid":"578db801c19cc73dbcbe69db","id":"578db780c19cc73dbcbd1d1a","title":"St. Andrew","$$hashKey":"object:1001"}],"$$hashKey":"object:948"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69dc","title":"Glennallen, Valdez-Cordova Co.","children":[{"parentid":"578db801c19cc73dbcbe69dc","id":"578db780c19cc73dbcbd1d1b","title":"Holy Family","$$hashKey":"object:1002"}],"$$hashKey":"object:949"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69dd","title":"Homer, Kenai Peninsula Borough","children":[{"parentid":"578db801c19cc73dbcbe69dd","id":"578db780c19cc73dbcbd1d1c","title":"St. John the Baptist","children":[{"parentid":"578db780c19cc73dbcbd1d1c","id":"578db782c19cc73dbcbd2083","title":"St. Peter the Apostle","$$hashKey":"object:1040"}],"$$hashKey":"object:998"}],"$$hashKey":"object:950"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69de","title":"Kenai, Kenai Peninsula Borough","children":[{"parentid":"578db801c19cc73dbcbe69de","id":"578db780c19cc73dbcbd1d1d","title":"Our Lady of the Angels","$$hashKey":"object:999"}],"$$hashKey":"object:951"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69df","title":"Kodiak, Kodiak Island Borough","children":[{"parentid":"578db801c19cc73dbcbe69df","id":"578db780c19cc73dbcbd1d1e","title":"St. Mary's","$$hashKey":"object:1004"}],"$$hashKey":"object:952"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69e0","title":"Palmer, Matanuska-Susitna Borough","children":[{"parentid":"578db801c19cc73dbcbe69e0","id":"578db780c19cc73dbcbd1d1f","title":"St. Michael","$$hashKey":"object:1006"}],"$$hashKey":"object:953"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69e1","title":"Seward, Kenai Peninsula Borough","children":[{"parentid":"578db801c19cc73dbcbe69e1","id":"578db780c19cc73dbcbd1d20","title":"Sacred Heart","children":[{"parentid":"578db780c19cc73dbcbd1d20","id":"578db782c19cc73dbcbd2084","title":"St. John Neumann Church","$$hashKey":"object:1042"}],"$$hashKey":"object:1005"}],"$$hashKey":"object:954"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69e2","title":"Soldotna, Kenai Peninsula Borough","children":[{"parentid":"578db801c19cc73dbcbe69e2","id":"578db780c19cc73dbcbd1d21","title":"Our Lady of Perpetual Help","$$hashKey":"object:1003"}],"$$hashKey":"object:955"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69e3","title":"Talkeetna, Matanuska-Susitna Borough","children":[{"parentid":"578db801c19cc73dbcbe69e3","id":"578db780c19cc73dbcbd1d22","title":"St. Bernard","children":[{"parentid":"578db780c19cc73dbcbd1d22","id":"578db782c19cc73dbcbd2085","title":"St. Philip Benizi","$$hashKey":"object:1043"}],"$$hashKey":"object:1007"}],"$$hashKey":"object:956"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69e4","title":"Valdez, Valdez-Cordova Co.","children":[{"parentid":"578db801c19cc73dbcbe69e4","id":"578db780c19cc73dbcbd1d23","title":"St. Francis Xavier","$$hashKey":"object:1008"}],"$$hashKey":"object:957"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db801c19cc73dbcbe69e5","title":"Wasilla, Matanuska-Susitna Borough","children":[{"parentid":"578db801c19cc73dbcbe69e5","id":"578db780c19cc73dbcbd1d24","title":"Sacred Heart","$$hashKey":"object:1010"}],"$$hashKey":"object:958"},{"parentid":"578db780c19cc73dbcbd1b99","id":"578db873c19cc73dbcbfaaa0","title":"Big Lake, Matanuska-Susitna Borough","children":[{"parentid":"578db873c19cc73dbcbfaaa0","id":"578db850c19cc73dbcbf487d","title":"Corp. of Our Lady of the Lake Church","children":[{"parentid":"578db850c19cc73dbcbf487d","id":"578db782c19cc73dbcbd2086","title":"St. Christopher","$$hashKey":"object:1044"}],"$$hashKey":"object:1009"}],"$$hashKey":"object:959"}],"$$hashKey":"object:893"},{"parentid":"578db77fc19cc73dbcbd1b51","id":"578db783c19cc73dbcbd22ab","title":"CITY OF ANCHORAGE","children":[{"parentid":"578db783c19cc73dbcbd22ab","id":"578db77fc19cc73dbcbd19ed","title":"St. Paul Miki","$$hashKey":"object:936"},{"parentid":"578db783c19cc73dbcbd22ab","id":"578db780c19cc73dbcbd1d10","title":"Holy Family Cathedral","$$hashKey":"object:937"},{"parentid":"578db783c19cc73dbcbd22ab","id":"578db780c19cc73dbcbd1d11","title":"St. Anthony","$$hashKey":"object:938"},{"parentid":"578db783c19cc73dbcbd22ab","id":"578db780c19cc73dbcbd1d12","title":"St. Benedict","$$hashKey":"object:939"},{"parentid":"578db783c19cc73dbcbd22ab","id":"578db780c19cc73dbcbd1d13","title":"St. Elizabeth Ann Seton","children":[{"parentid":"578db780c19cc73dbcbd1d13","id":"578db782c19cc73dbcbd2081","title":"Our Lady of the Snows","$$hashKey":"object:996"}],"$$hashKey":"object:940"},{"parentid":"578db783c19cc73dbcbd22ab","id":"578db780c19cc73dbcbd1d14","title":"Holy Cross","$$hashKey":"object:941"},{"parentid":"578db783c19cc73dbcbd22ab","id":"578db780c19cc73dbcbd1d15","title":"Our Lady of Guadalupe Co Cathedral","$$hashKey":"object:942"},{"parentid":"578db783c19cc73dbcbd22ab","id":"578db780c19cc73dbcbd1d16","title":"St. Patrick","$$hashKey":"object:943"},{"parentid":"578db783c19cc73dbcbd22ab","id":"578db780c19cc73dbcbd1d19","title":"Corp. of St. Christopher By the Sea Church","$$hashKey":"object:944"},{"parentid":"578db783c19cc73dbcbd22ab","id":"578db850c19cc73dbcbf487a","title":"St. Andrew Kim","$$hashKey":"object:945"}],"$$hashKey":"object:894"}],"$$hashKey":"object:890"},{"parentid":"578db77ec19cc73dbcbd1970","id":"578db77fc19cc73dbcbd1b57","title":"Chaplains of Public Institutions","children":[{"parentid":"578db77fc19cc73dbcbd1b57","id":"578db782c19cc73dbcbd2194","title":"On Duty Outside Archdiocese","$$hashKey":"object:895"},{"parentid":"578db77fc19cc73dbcbd1b57","id":"578db783c19cc73dbcbd21ab","title":"Retired","$$hashKey":"object:896"},{"parentid":"578db77fc19cc73dbcbd1b57","id":"578db783c19cc73dbcbd21b1","title":"Permanent Deacons","$$hashKey":"object:897"}],"$$hashKey":"object:891"},{"parentid":"578db77ec19cc73dbcbd1970","id":"578db77fc19cc73dbcbd1b5d","title":"Institutions Located in Diocese","children":[{"parentid":"578db77fc19cc73dbcbd1b5d","id":"578db780c19cc73dbcbd1b9a","title":"[A] GRADE SCHOOLS, HIGH SCHOOLS  PAROCHIAL","children":[{"parentid":"578db780c19cc73dbcbd1b9a","id":"578db801c19cc73dbcbe69e6","title":"Anchorage","children":[{"parentid":"578db801c19cc73dbcbe69e6","id":"578db77fc19cc73dbcbd1ad0","title":"St. Elizabeth Ann Seton School","$$hashKey":"object:1011"},{"parentid":"578db801c19cc73dbcbe69e6","id":"578db77fc19cc73dbcbd1b26","title":"Lumen Christi High School","$$hashKey":"object:1012"},{"parentid":"578db801c19cc73dbcbe69e6","id":"578db77fc19cc73dbcbd1b2e","title":"Holy Rosary Academy","$$hashKey":"object:1013"}],"$$hashKey":"object:970"},{"parentid":"578db780c19cc73dbcbd1b9a","id":"578db801c19cc73dbcbe69e7","title":"Kodiak","children":[{"parentid":"578db801c19cc73dbcbe69e7","id":"578db77fc19cc73dbcbd1af2","title":"St. Mary's","$$hashKey":"object:1014"}],"$$hashKey":"object:971"},{"parentid":"578db780c19cc73dbcbd1b9a","id":"578db856c19cc73dbcbf583a","title":"Wasilla","children":[{"parentid":"578db856c19cc73dbcbf583a","id":"578db852c19cc73dbcbf4efb","title":"Corp. of Our Lady of the Valley Catholic School, Inc.","$$hashKey":"object:1020"}],"$$hashKey":"object:972"}],"$$hashKey":"object:926"},{"parentid":"578db77fc19cc73dbcbd1b5d","id":"578db780c19cc73dbcbd1b9b","title":"[B] GENERAL HOSPITALS","children":[{"parentid":"578db780c19cc73dbcbd1b9b","id":"578db801c19cc73dbcbe69e8","title":"Anchorage","children":[{"parentid":"578db801c19cc73dbcbe69e8","id":"578db783c19cc73dbcbd21d0","title":"Providence Alaska Medical Center","$$hashKey":"object:1026"}],"$$hashKey":"object:977"},{"parentid":"578db780c19cc73dbcbd1b9b","id":"578db801c19cc73dbcbe69e9","title":"Kodiak","children":[{"parentid":"578db801c19cc73dbcbe69e9","id":"578db783c19cc73dbcbd21d2","title":"Providence Kodiak Island Medical Center","$$hashKey":"object:1027"}],"$$hashKey":"object:978"},{"parentid":"578db780c19cc73dbcbd1b9b","id":"578db801c19cc73dbcbe69ea","title":"Seward","children":[{"parentid":"578db801c19cc73dbcbe69ea","id":"578db783c19cc73dbcbd21d1","title":"Providence Seward Medical Center","$$hashKey":"object:1028"}],"$$hashKey":"object:979"},{"parentid":"578db780c19cc73dbcbd1b9b","id":"578db84ec19cc73dbcbf42c6","title":"Valdez","children":[{"parentid":"578db84ec19cc73dbcbf42c6","id":"578db84dc19cc73dbcbf413c","title":"Providence Valdez Medical Center","$$hashKey":"object:1025"}],"$$hashKey":"object:980"}],"$$hashKey":"object:927"},{"parentid":"578db77fc19cc73dbcbd1b5d","id":"578db780c19cc73dbcbd1b9c","title":"[C] NURSING HOMES","children":[{"parentid":"578db780c19cc73dbcbd1b9c","id":"578db801c19cc73dbcbe69eb","title":"Anchorage","children":[{"parentid":"578db801c19cc73dbcbe69eb","id":"578db783c19cc73dbcbd2259","title":"Providence Extended Care Center","$$hashKey":"object:1029"}],"$$hashKey":"object:981"}],"$$hashKey":"object:928"},{"parentid":"578db77fc19cc73dbcbd1b5d","id":"578db780c19cc73dbcbd1b9d","title":"[D] CATHOLIC SOCIAL SERVICES","children":[{"parentid":"578db780c19cc73dbcbd1b9d","id":"578db801c19cc73dbcbe69ec","title":"Anchorage","children":[{"parentid":"578db801c19cc73dbcbe69ec","id":"578db783c19cc73dbcbd21df","title":"Brother Francis Shelter","$$hashKey":"object:1015"},{"parentid":"578db801c19cc73dbcbe69ec","id":"578db783c19cc73dbcbd2282","title":"Catholic Social Services Center","children":[{"parentid":"578db783c19cc73dbcbd2282","id":"578db783c19cc73dbcbd2283","title":"Catholic Social Services Center","$$hashKey":"object:1045"}],"$$hashKey":"object:1016"},{"parentid":"578db801c19cc73dbcbe69ec","id":"578db783c19cc73dbcbd2284","title":"Clare House","$$hashKey":"object:1017"},{"parentid":"578db801c19cc73dbcbe69ec","id":"578db783c19cc73dbcbd2286","title":"Charlie Elder House","$$hashKey":"object:1018"}],"$$hashKey":"object:973"},{"parentid":"578db780c19cc73dbcbd1b9d","id":"578db82cc19cc73dbcbee4a6","title":"Kodiak","children":[{"parentid":"578db82cc19cc73dbcbee4a6","id":"578db82cc19cc73dbcbee482","title":"Marian Center, Inc.","$$hashKey":"object:1019"}],"$$hashKey":"object:974"}],"$$hashKey":"object:929"},{"parentid":"578db77fc19cc73dbcbd1b5d","id":"578db780c19cc73dbcbd1b9e","title":"[E] CONVENTS AND RESIDENCES FOR SISTERS","children":[{"parentid":"578db780c19cc73dbcbd1b9e","id":"578db801c19cc73dbcbe69ed","title":"Anchorage","children":[{"parentid":"578db801c19cc73dbcbe69ed","id":"578db783c19cc73dbcbd2220","title":"Daughters of Charity","$$hashKey":"object:1022"},{"parentid":"578db801c19cc73dbcbe69ed","id":"578db783c19cc73dbcbd2221","title":"Sisters of Perpetual Adoration","$$hashKey":"object:1023"},{"parentid":"578db801c19cc73dbcbe69ed","id":"578db783c19cc73dbcbd2222","title":"Sisters of St. Paul de Chartres","$$hashKey":"object:1024"}],"$$hashKey":"object:975"}],"$$hashKey":"object:930"},{"parentid":"578db77fc19cc73dbcbd1b5d","id":"578db780c19cc73dbcbd1b9f","title":"[F] RETREAT HOUSES","children":[{"parentid":"578db780c19cc73dbcbd1b9f","id":"578db801c19cc73dbcbe69ee","title":"Anchorage","children":[{"parentid":"578db801c19cc73dbcbe69ee","id":"578db783c19cc73dbcbd2299","title":"Holy Spirit Center","$$hashKey":"object:1021"}],"$$hashKey":"object:976"}],"$$hashKey":"object:931"},{"parentid":"578db77fc19cc73dbcbd1b5d","id":"578db780c19cc73dbcbd1ba0","title":"[G] MISCELLANEOUS","children":[{"parentid":"578db780c19cc73dbcbd1ba0","id":"578db801c19cc73dbcbe69ef","title":"Anchorage","children":[{"parentid":"578db801c19cc73dbcbe69ef","id":"578db780c19cc73dbcbd1c45","title":"Providence Health System Housing","$$hashKey":"object:1030"},{"parentid":"578db801c19cc73dbcbe69ef","id":"578db780c19cc73dbcbd1c46","title":"Providence Home Health Care, Anchorage, Alaska","$$hashKey":"object:1031"},{"parentid":"578db801c19cc73dbcbe69ef","id":"578db783c19cc73dbcbd21e0","title":"Covenant House Alaska","$$hashKey":"object:1032"},{"parentid":"578db801c19cc73dbcbe69ef","id":"578db783c19cc73dbcbd229a","title":"Catholic Retreat House Ministries, Inc.","$$hashKey":"object:1033"},{"parentid":"578db801c19cc73dbcbe69ef","id":"578db783c19cc73dbcbd22e9","title":"Catholic Foundation of Alaska","$$hashKey":"object:1034"},{"parentid":"578db801c19cc73dbcbe69ef","id":"578db783c19cc73dbcbd22ea","title":"Archdiocese of Anchorage Priests Pension Trust","$$hashKey":"object:1035"},{"parentid":"578db801c19cc73dbcbe69ef","id":"578db783c19cc73dbcbd22eb","title":"Providence Alaska Foundation, Anchorage, Alaska","$$hashKey":"object:1036"},{"parentid":"578db801c19cc73dbcbe69ef","id":"578db862c19cc73dbcbf7b0e","title":"St. Catherine of Siena CUF Chapter, Inc.","$$hashKey":"object:1037"},{"parentid":"578db801c19cc73dbcbe69ef","id":"578db866c19cc73dbcbf8587","title":"Alaska Conference of Catholic Bishops","$$hashKey":"object:1038"}],"$$hashKey":"object:994"},{"parentid":"578db780c19cc73dbcbd1ba0","id":"578db84ec19cc73dbcbf42c7","title":"Palmer","children":[{"parentid":"578db84ec19cc73dbcbf42c7","id":"578db84bc19cc73dbcbf3b4d","title":"Bishop's Attic II, Inc.","$$hashKey":"object:1039"}],"$$hashKey":"object:995"}],"$$hashKey":"object:932"},{"parentid":"578db77fc19cc73dbcbd1b5d","id":"578db783c19cc73dbcbd22a0","title":"NECROLOGY","$$hashKey":"object:933"},{"parentid":"578db77fc19cc73dbcbd1b5d","id":"578db783c19cc73dbcbd22ac","title":"RELIGIOUS INSTITUTES OF MEN REPRESENTED IN THE ARCHDIOCESE","children":[{"parentid":"578db783c19cc73dbcbd22ac","id":"578db77fc19cc73dbcbd1a56","title":"Order of Preachers-Dominicans","$$hashKey":"object:982"},{"parentid":"578db783c19cc73dbcbd22ac","id":"578db77fc19cc73dbcbd1a58","title":"Oblates of Mary Immaculate","$$hashKey":"object:983"},{"parentid":"578db783c19cc73dbcbd22ac","id":"578db830c19cc73dbcbeede6","title":"For further details refer to the corresponding bracketed number in the Religious Institutes of Men or Women section.","$$hashKey":"object:984"},{"parentid":"578db783c19cc73dbcbd22ac","id":"578db86cc19cc73dbcbf97f6","title":"Benedictine Monks","$$hashKey":"object:985"},{"parentid":"578db783c19cc73dbcbd22ac","id":"578db870c19cc73dbcbfa251","title":"Congregation of the Western Mission","$$hashKey":"object:986"},{"parentid":"578db783c19cc73dbcbd22ac","id":"578db870c19cc73dbcbfa287","title":"Vincentians","$$hashKey":"object:987"}],"$$hashKey":"object:934"},{"parentid":"578db77fc19cc73dbcbd1b5d","id":"578db783c19cc73dbcbd22ad","title":"RELIGIOUS INSTITUTES OF WOMEN REPRESENTED IN THE ARCHDIOCESE","children":[{"parentid":"578db783c19cc73dbcbd22ad","id":"578db77fc19cc73dbcbd1a9d","title":"Little Sisters of Jesus","$$hashKey":"object:988"},{"parentid":"578db783c19cc73dbcbd22ad","id":"578db77fc19cc73dbcbd1a9f","title":"Nuns of Perpetual Adoration of the Blessed Sacrament","$$hashKey":"object:989"},{"parentid":"578db783c19cc73dbcbd22ad","id":"578db77fc19cc73dbcbd1aa0","title":"Sisters of the Most Precious Blood","$$hashKey":"object:990"},{"parentid":"578db783c19cc73dbcbd22ad","id":"578db77fc19cc73dbcbd1aa3","title":"Sisters of St. Paul de Chartres","$$hashKey":"object:991"},{"parentid":"578db783c19cc73dbcbd22ad","id":"578db77fc19cc73dbcbd1aa4","title":"Daughters of Charity of St. Vincent DePaul","$$hashKey":"object:992"},{"parentid":"578db783c19cc73dbcbd22ad","id":"578db856c19cc73dbcbf59d2","title":"Sisters of the Immaculate Heart of Mary, Mother of Christ","$$hashKey":"object:993"}],"$$hashKey":"object:935"}],"$$hashKey":"object:892"}];
	console.log("todoList.treeDataOfData",todoList.treeDataOfData);
	var root="578db77ec19cc73dbcbd1970";
	var x2=$resource("/dbData",{},{ 'Data':    {method:'POST',isArray:true}});
	var x3=$resource("/tree",{},{'Data':{method:'POST',isArray:true}});
	x3.Data({"directoryId":{"_eval": "Id", "value": "57189cd924d8bc65f4123bc3"},"root":{"_eval": "Id", "value": "578db77ec19cc73dbcbd1970"},"name":{"$ne":null},"status":{"_eval": "Id", "value": "57283b4214dde6a43b46a7bb"}}).$promise
	.then(function(resp){

			var RESP =angular.copy(resp);
				var dfilter=_.filter(RESP,{parentId:"578db77ec19cc73dbcbd1970"});
				for(var i=0;i<dfilter.length;i++)
				{
							dfilter=_.concat(dfilter,_.filter(RESP,{parentId:dfilter[i]._id}));
				}		

				todoList.t=	x3unflatten(angular.copy(dfilter));
				console.log(todoList.t);

			 	
	});
function x3unflatten(nodes){
nodes=nodes.map(function(d){ d.id=d._id; return d;});
var map = {}, _node, roots = [];
for (var i = 0; i < nodes.length; i += 1) {
    _node = nodes[i];
    _node.children = [];
    map[_node.id] = i; // use map to look-up the parents
    if (_node.parentId !== "578db77ec19cc73dbcbd1970") {
	_node.children = [];
        nodes[map[_node.parentId]].children.push(_node);
    } else {
        roots.push(_node);
    }
}
	return roots;
}
	
	
	//var qr={ "parentId": {"_eval":"Id","value":"578db77fc19cc73dbcbd1b40"}, "directoryId": {"_eval":"Id","value":"57189cd924d8bc65f4123bc3"}};
	/*
	var qr={ "parentId": {"_eval":"Id","value":"578db77ec19cc73dbcbd1970"}, "directoryId": {"_eval":"Id","value":"57189cd924d8bc65f4123bc3"}};
	x2.Data(qr).$promise.then(function(resp){
			
	});*/
	todoList.all=[];
	todoList.TREE=[];
	todoList.dis=dis;
	function dis(){

		//todoList.treeDataOfData=todoList.all;
		todoList.treeDataOfData=angular.copy(todoList.all);
		//todoList.treeDataOfData=_.cloneDeep(todoList.all);
		//todoList.treeDataOfData=angular.toJson(todoList.all);
		console.log(unflatten(todoList.treeDataOfData));
		
	}
	function show(qr)
	{
	
		var d=x2.Data(qr).$promise.then(function(resp){					
			var temp={};
			temp.parentid=qr.parentId.value;
			
				for(var i=0;i<resp.length;i++)
				{
					temp.id=resp[i]._id;
					temp.title=resp[i].name;
					todoList.all.push(angular.copy(temp));
					// setTimeout(function(){
					// 	todoList.all=todoList.TREE;
					// 	console.log(unflatten(todoList.all));
					// },10000)
					 //todoList.TREE.push(_.cloneDeep(temp));
					show({ "parentId": {"_eval":"Id","value":resp[i]._id}, "directoryId": {"_eval":"Id","value":"57189cd924d8bc65f4123bc3"},"name": { $ne: null },"status":{"_eval":"Id","value":"57283b4214dde6a43b46a7bb"}});
				}
		});
	}
	function unflatten( array, parent, tree ){
    tree = typeof tree !== 'undefined' ? tree : [];
    parent = typeof parent !== 'undefined' ? parent : { id: root};
    var children = _.filter( array, function(child){ return child.parentid == parent.id; });
    if( !_.isEmpty( children )  ){
        if( parent.id == root ){
           tree = children;   
        }else{
           parent['children'] = children
        }
        _.each( children, function( child ){ unflatten( array, child ) } );                    
    }
    return tree;
}

	function dmain() {
	
	show({ "parentId": {"_eval":"Id","value":"578db77ec19cc73dbcbd1970"}, "directoryId": {"_eval":"Id","value":"57189cd924d8bc65f4123bc3"},"name": { $ne: null },"status":{"_eval":"Id","value":"57283b4214dde6a43b46a7bb"}}); 
	console.log("end");
	}
	dmain();
	console.log("end123");
  });