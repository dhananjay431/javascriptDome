  //console.log(JSON.stringify(tree, null, " "));

angular.module('todoApp', ['ngResource'])
  .controller('TodoListController', function($resource) {
    var todoList = this;
	todoList.ddiiss=ddiiss;
	function ddiiss(data){
	console.log(data);
	}
	var root="";

	var x2=$resource("/dbData",{},{ 'Data':    {method:'POST',isArray:true}});
	
	
	//var qr={ "parentId": {"_eval":"Id","value":"578db77fc19cc73dbcbd1b40"}, "directoryId": {"_eval":"Id","value":"57189cd924d8bc65f4123bc3"}};
	/*
	var qr={ "parentId": {"_eval":"Id","value":"578db77ec19cc73dbcbd1970"}, "directoryId": {"_eval":"Id","value":"57189cd924d8bc65f4123bc3"}};
	x2.Data(qr).$promise.then(function(resp){
			
	});*/
	todoList.all=[];
	todoList.show=show;
	var tree=$resource("/tree",{},{ 'Data':    {method:'POST',isArray:true}});
	
	function showtree(nodes){
	nodes=nodes.map(function(d){  d.children=[]; return d;})
		var map = {}, node, roots = [];
			for (var i = 0; i < nodes.length; i += 1) {
				node = nodes[i];
				node.children = [];
				map[node._id] = i; // use map to look-up the parents
				if (node.parentId !== "578db77ec19cc73dbcbd1970") {
					nodes[map[node.parentId]].children.push(node);
				} else {
					roots.push(node);
				}
			}
		return roots;
	}

	function show()
	{
		console.log("show",todoList.parent);
		
			tree.Data({ "root": {"_eval":"Id","value":todoList.parent}, "directoryId": {"_eval":"Id","value":"57189cd924d8bc65f4123bc3"},"name": { $ne: null },"active": true,"deleted":false})
			.$promise.then(function(resp){	
				
				todoList.td=showtree(resp);
				console.log();
				/*
				function bunflatten(nodes){
				var map = {}, _node, roots = [];
				for (var i = 0; i < nodes.length; i += 1) {
					_node = nodes[i];
					_node.children = [];
					map[_node._id] = i; 
					if (_node.parentId !== todoList.parent) {
					_node.children = [];
						nodes[map[_node.parentId]].children.push(_node);
					} else {
						roots.push(_node);
					}
				}
					return roots;
				}
				
				todoList.td=bunflatten(d);
				*/
	});
	
	}
	

  });

  /*
	var data =[{"_id":"578db77fc19cc73dbcbd19ed","parentId":"578db783c19cc73dbcbd22ab","name":"St. Paul Miki"},{"_id":"578db77fc19cc73dbcbd1a56","parentId":"578db783c19cc73dbcbd22ac","name":"Order of Preachers-Dominicans"},{"_id":"578db77fc19cc73dbcbd1a57","parentId":"578db783c19cc73dbcbd22ac","name":"Marist Fathers"},{"_id":"578db77fc19cc73dbcbd1a58","parentId":"578db783c19cc73dbcbd22ac","name":"Oblates of Mary Immaculate"},{"_id":"578db77fc19cc73dbcbd1a9b","parentId":"578db783c19cc73dbcbd22ad","name":"School Sisters of St. Francis"},{"_id":"578db77fc19cc73dbcbd1a9c","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of the Holy Family"},{"_id":"578db77fc19cc73dbcbd1a9d","parentId":"578db783c19cc73dbcbd22ad","name":"Little Sisters of Jesus"},{"_id":"578db77fc19cc73dbcbd1a9e","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of Mercy of the Americas"},{"_id":"578db77fc19cc73dbcbd1a9f","parentId":"578db783c19cc73dbcbd22ad","name":"Nuns of Perpetual Adoration of the Blessed Sacrament"},{"_id":"578db77fc19cc73dbcbd1aa0","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of the Most Precious Blood"},{"_id":"578db77fc19cc73dbcbd1aa1","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of St. Joseph of Peace"},{"_id":"578db77fc19cc73dbcbd1aa2","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of Mercy of the Americas"},{"_id":"578db77fc19cc73dbcbd1aa3","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of St. Paul de Chartres"},{"_id":"578db77fc19cc73dbcbd1aa4","parentId":"578db783c19cc73dbcbd22ad","name":"Daughters of Charity of St. Vincent DePaul"},{"_id":"578db77fc19cc73dbcbd1ad0","parentId":"578db801c19cc73dbcbe69e6","name":"St. Elizabeth Ann Seton School"},{"_id":"578db77fc19cc73dbcbd1af2","parentId":"578db801c19cc73dbcbe69e7","name":"St. Mary's"},{"_id":"578db77fc19cc73dbcbd1b26","parentId":"578db801c19cc73dbcbe69e6","name":"Lumen Christi High School"},{"_id":"578db77fc19cc73dbcbd1b2e","parentId":"578db801c19cc73dbcbe69e6","name":"Holy Rosary Academy"},{"_id":"578db77fc19cc73dbcbd1b3f","parentId":"578db77ec19cc73dbcbd1970","name":"Masthead"},{"_id":"578db77fc19cc73dbcbd1b45","parentId":"578db77ec19cc73dbcbd1970","name":"Statistics"},{"_id":"578db77fc19cc73dbcbd1b4b","parentId":"578db77ec19cc73dbcbd1970","name":"Curia"},{"_id":"578db77fc19cc73dbcbd1b51","parentId":"578db77ec19cc73dbcbd1970","name":"Clergy, Parish, Missions"},{"_id":"578db77fc19cc73dbcbd1b57","parentId":"578db77ec19cc73dbcbd1970","name":"Chaplains of Public Institutions"},{"_id":"578db77fc19cc73dbcbd1b5d","parentId":"578db77ec19cc73dbcbd1970","name":"Institutions Located in Diocese"},{"_id":"578db780c19cc73dbcbd1b99","parentId":"578db77fc19cc73dbcbd1b51","name":"OUTSIDE THE CITY OF ANCHORAGE"},{"_id":"578db780c19cc73dbcbd1b9a","parentId":"578db77fc19cc73dbcbd1b5d","name":"[A] GRADE SCHOOLS, HIGH SCHOOLS  PAROCHIAL"},{"_id":"578db780c19cc73dbcbd1b9b","parentId":"578db77fc19cc73dbcbd1b5d","name":"[B] GENERAL HOSPITALS"},{"_id":"578db780c19cc73dbcbd1b9c","parentId":"578db77fc19cc73dbcbd1b5d","name":"[C] NURSING HOMES"},{"_id":"578db780c19cc73dbcbd1b9d","parentId":"578db77fc19cc73dbcbd1b5d","name":"[D] CATHOLIC SOCIAL SERVICES"},{"_id":"578db780c19cc73dbcbd1b9e","parentId":"578db77fc19cc73dbcbd1b5d","name":"[E] CONVENTS AND RESIDENCES FOR SISTERS"},{"_id":"578db780c19cc73dbcbd1b9f","parentId":"578db77fc19cc73dbcbd1b5d","name":"[F] RETREAT HOUSES"},{"_id":"578db780c19cc73dbcbd1ba0","parentId":"578db77fc19cc73dbcbd1b5d","name":"[G] MISCELLANEOUS"},{"_id":"578db780c19cc73dbcbd1c45","parentId":"578db801c19cc73dbcbe69ef","name":"Providence Health System Housing"},{"_id":"578db780c19cc73dbcbd1c46","parentId":"578db801c19cc73dbcbe69ef","name":"Providence Home Health Care, Anchorage, Alaska"},{"_id":"578db780c19cc73dbcbd1d10","parentId":"578db783c19cc73dbcbd22ab","name":"Holy Family Cathedral"},{"_id":"578db780c19cc73dbcbd1d11","parentId":"578db783c19cc73dbcbd22ab","name":"St. Anthony"},{"_id":"578db780c19cc73dbcbd1d12","parentId":"578db783c19cc73dbcbd22ab","name":"St. Benedict"},{"_id":"578db780c19cc73dbcbd1d13","parentId":"578db783c19cc73dbcbd22ab","name":"St. Elizabeth Ann Seton"},{"_id":"578db780c19cc73dbcbd1d14","parentId":"578db783c19cc73dbcbd22ab","name":"Holy Cross"},{"_id":"578db780c19cc73dbcbd1d15","parentId":"578db783c19cc73dbcbd22ab","name":"Our Lady of Guadalupe Co Cathedral"},{"_id":"578db780c19cc73dbcbd1d16","parentId":"578db783c19cc73dbcbd22ab","name":"St. Patrick"},{"_id":"578db780c19cc73dbcbd1d17","parentId":"578db801c19cc73dbcbe69d9","name":"St. Joseph"},{"_id":"578db780c19cc73dbcbd1d18","parentId":"578db801c19cc73dbcbe69da","name":"Holy Rosary"},{"_id":"578db780c19cc73dbcbd1d19","parentId":"578db783c19cc73dbcbd22ab","name":"Corp. of St. Christopher By the Sea Church"},{"_id":"578db780c19cc73dbcbd1d1a","parentId":"578db801c19cc73dbcbe69db","name":"St. Andrew"},{"_id":"578db780c19cc73dbcbd1d1b","parentId":"578db801c19cc73dbcbe69dc","name":"Holy Family"},{"_id":"578db780c19cc73dbcbd1d1c","parentId":"578db801c19cc73dbcbe69dd","name":"St. John the Baptist"},{"_id":"578db780c19cc73dbcbd1d1d","parentId":"578db801c19cc73dbcbe69de","name":"Our Lady of the Angels"},{"_id":"578db780c19cc73dbcbd1d1e","parentId":"578db801c19cc73dbcbe69df","name":"St. Mary's"},{"_id":"578db780c19cc73dbcbd1d1f","parentId":"578db801c19cc73dbcbe69e0","name":"St. Michael"},{"_id":"578db780c19cc73dbcbd1d20","parentId":"578db801c19cc73dbcbe69e1","name":"Sacred Heart"},{"_id":"578db780c19cc73dbcbd1d21","parentId":"578db801c19cc73dbcbe69e2","name":"Our Lady of Perpetual Help"},{"_id":"578db780c19cc73dbcbd1d22","parentId":"578db801c19cc73dbcbe69e3","name":"St. Bernard"},{"_id":"578db780c19cc73dbcbd1d23","parentId":"578db801c19cc73dbcbe69e4","name":"St. Francis Xavier"},{"_id":"578db780c19cc73dbcbd1d24","parentId":"578db801c19cc73dbcbe69e5","name":"Sacred Heart"},{"_id":"578db782c19cc73dbcbd2081","parentId":"578db780c19cc73dbcbd1d13","name":"Our Lady of the Snows"},{"_id":"578db782c19cc73dbcbd2082","parentId":"578db780c19cc73dbcbd1d18","name":"St. Theresa"},{"_id":"578db782c19cc73dbcbd2083","parentId":"578db780c19cc73dbcbd1d1c","name":"St. Peter the Apostle"},{"_id":"578db782c19cc73dbcbd2084","parentId":"578db780c19cc73dbcbd1d20","name":"St. John Neumann Church"},{"_id":"578db782c19cc73dbcbd2085","parentId":"578db780c19cc73dbcbd1d22","name":"St. Philip Benizi"},{"_id":"578db782c19cc73dbcbd2086","parentId":"578db850c19cc73dbcbf487d","name":"St. Christopher"},{"_id":"578db782c19cc73dbcbd2194","parentId":"578db77fc19cc73dbcbd1b57","name":"On Duty Outside Archdiocese"},{"_id":"578db783c19cc73dbcbd21ab","parentId":"578db77fc19cc73dbcbd1b57","name":"Retired"},{"_id":"578db783c19cc73dbcbd21b1","parentId":"578db77fc19cc73dbcbd1b57","name":"Permanent Deacons"},{"_id":"578db783c19cc73dbcbd21d0","parentId":"578db801c19cc73dbcbe69e8","name":"Providence Alaska Medical Center"},{"_id":"578db783c19cc73dbcbd21d1","parentId":"578db801c19cc73dbcbe69ea","name":"Providence Seward Medical Center"},{"_id":"578db783c19cc73dbcbd21d2","parentId":"578db801c19cc73dbcbe69e9","name":"Providence Kodiak Island Medical Center"},{"_id":"578db783c19cc73dbcbd21df","parentId":"578db801c19cc73dbcbe69ec","name":"Brother Francis Shelter"},{"_id":"578db783c19cc73dbcbd21e0","parentId":"578db801c19cc73dbcbe69ef","name":"Covenant House Alaska"},{"_id":"578db783c19cc73dbcbd2220","parentId":"578db801c19cc73dbcbe69ed","name":"Daughters of Charity"},{"_id":"578db783c19cc73dbcbd2221","parentId":"578db801c19cc73dbcbe69ed","name":"Sisters of Perpetual Adoration"},{"_id":"578db783c19cc73dbcbd2222","parentId":"578db801c19cc73dbcbe69ed","name":"Sisters of St. Paul de Chartres"},{"_id":"578db783c19cc73dbcbd2259","parentId":"578db801c19cc73dbcbe69eb","name":"Providence Extended Care Center"},{"_id":"578db783c19cc73dbcbd2282","parentId":"578db801c19cc73dbcbe69ec","name":"Catholic Social Services Center"},{"_id":"578db783c19cc73dbcbd2283","parentId":"578db783c19cc73dbcbd2282","name":"Catholic Social Services Center"},{"_id":"578db783c19cc73dbcbd2284","parentId":"578db801c19cc73dbcbe69ec","name":"Clare House"},{"_id":"578db783c19cc73dbcbd2285","parentId":"578db801c19cc73dbcbe69ec","name":"McAuley Manor"},{"_id":"578db783c19cc73dbcbd2286","parentId":"578db801c19cc73dbcbe69ec","name":"Charlie Elder House"},{"_id":"578db783c19cc73dbcbd2299","parentId":"578db801c19cc73dbcbe69ee","name":"Holy Spirit Center"},{"_id":"578db783c19cc73dbcbd229a","parentId":"578db801c19cc73dbcbe69ef","name":"Catholic Retreat House Ministries, Inc."},{"_id":"578db783c19cc73dbcbd22a0","parentId":"578db77fc19cc73dbcbd1b5d","name":"NECROLOGY"},{"_id":"578db783c19cc73dbcbd22ab","parentId":"578db77fc19cc73dbcbd1b51","name":"CITY OF ANCHORAGE"},{"_id":"578db783c19cc73dbcbd22ac","parentId":"578db77fc19cc73dbcbd1b5d","name":"RELIGIOUS INSTITUTES OF MEN REPRESENTED IN THE ARCHDIOCESE"},{"_id":"578db783c19cc73dbcbd22ad","parentId":"578db77fc19cc73dbcbd1b5d","name":"RELIGIOUS INSTITUTES OF WOMEN REPRESENTED IN THE ARCHDIOCESE"},{"_id":"578db783c19cc73dbcbd22e9","parentId":"578db801c19cc73dbcbe69ef","name":"Catholic Foundation of Alaska"},{"_id":"578db783c19cc73dbcbd22ea","parentId":"578db801c19cc73dbcbe69ef","name":"Archdiocese of Anchorage Priests Pension Trust"},{"_id":"578db783c19cc73dbcbd22eb","parentId":"578db801c19cc73dbcbe69ef","name":"Providence Alaska Foundation, Anchorage, Alaska"},{"_id":"578db801c19cc73dbcbe69d9","parentId":"578db780c19cc73dbcbd1b99","name":"Cordova, Valdez-Cordova Co."},{"_id":"578db801c19cc73dbcbe69da","parentId":"578db780c19cc73dbcbd1b99","name":"Dillingham, Dillingham Co."},{"_id":"578db801c19cc73dbcbe69db","parentId":"578db780c19cc73dbcbd1b99","name":"Eagle River, Anchorage Borough"},{"_id":"578db801c19cc73dbcbe69dc","parentId":"578db780c19cc73dbcbd1b99","name":"Glennallen, Valdez-Cordova Co."},{"_id":"578db801c19cc73dbcbe69dd","parentId":"578db780c19cc73dbcbd1b99","name":"Homer, Kenai Peninsula Borough"},{"_id":"578db801c19cc73dbcbe69de","parentId":"578db780c19cc73dbcbd1b99","name":"Kenai, Kenai Peninsula Borough"},{"_id":"578db801c19cc73dbcbe69df","parentId":"578db780c19cc73dbcbd1b99","name":"Kodiak, Kodiak Island Borough"},{"_id":"578db801c19cc73dbcbe69e0","parentId":"578db780c19cc73dbcbd1b99","name":"Palmer, Matanuska-Susitna Borough"},{"_id":"578db801c19cc73dbcbe69e1","parentId":"578db780c19cc73dbcbd1b99","name":"Seward, Kenai Peninsula Borough"},{"_id":"578db801c19cc73dbcbe69e2","parentId":"578db780c19cc73dbcbd1b99","name":"Soldotna, Kenai Peninsula Borough"},{"_id":"578db801c19cc73dbcbe69e3","parentId":"578db780c19cc73dbcbd1b99","name":"Talkeetna, Matanuska-Susitna Borough"},{"_id":"578db801c19cc73dbcbe69e4","parentId":"578db780c19cc73dbcbd1b99","name":"Valdez, Valdez-Cordova Co."},{"_id":"578db801c19cc73dbcbe69e5","parentId":"578db780c19cc73dbcbd1b99","name":"Wasilla, Matanuska-Susitna Borough"},{"_id":"578db801c19cc73dbcbe69e6","parentId":"578db780c19cc73dbcbd1b9a","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69e7","parentId":"578db780c19cc73dbcbd1b9a","name":"Kodiak"},{"_id":"578db801c19cc73dbcbe69e8","parentId":"578db780c19cc73dbcbd1b9b","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69e9","parentId":"578db780c19cc73dbcbd1b9b","name":"Kodiak"},{"_id":"578db801c19cc73dbcbe69ea","parentId":"578db780c19cc73dbcbd1b9b","name":"Seward"},{"_id":"578db801c19cc73dbcbe69eb","parentId":"578db780c19cc73dbcbd1b9c","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69ec","parentId":"578db780c19cc73dbcbd1b9d","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69ed","parentId":"578db780c19cc73dbcbd1b9e","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69ee","parentId":"578db780c19cc73dbcbd1b9f","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69ef","parentId":"578db780c19cc73dbcbd1ba0","name":"Anchorage"},{"_id":"578db816c19cc73dbcbea659","parentId":"578db77fc19cc73dbcbd1b4b","name":"Archdiocesan Offices and Directors"},{"_id":"578db816c19cc73dbcbea755","parentId":"578db77fc19cc73dbcbd1b4b","name":"Former Archbishops"},{"_id":"578db816c19cc73dbcbea756","parentId":"578db77fc19cc73dbcbd1b4b","name":"Vicar General"},{"_id":"578db816c19cc73dbcbea757","parentId":"578db77fc19cc73dbcbd1b4b","name":"Pastoral Center"},{"_id":"578db816c19cc73dbcbea758","parentId":"578db77fc19cc73dbcbd1b4b","name":"Secretary to Archbishop Emeritus"},{"_id":"578db816c19cc73dbcbea759","parentId":"578db77fc19cc73dbcbd1b4b","name":"Secretary to Archbishop Roger L. Schwietz, O.M.I."},{"_id":"578db816c19cc73dbcbea75a","parentId":"578db77fc19cc73dbcbd1b4b","name":"Stewardship/Development Office"},{"_id":"578db816c19cc73dbcbea75b","parentId":"578db77fc19cc73dbcbd1b4b","name":"Tribunal"},{"_id":"578db816c19cc73dbcbea75c","parentId":"578db816c19cc73dbcbea75b","name":"Defender of the Bond"},{"_id":"578db816c19cc73dbcbea75d","parentId":"578db816c19cc73dbcbea75b","name":"Notaries"},{"_id":"578db816c19cc73dbcbea75e","parentId":"578db77fc19cc73dbcbd1b4b","name":"Diocesan Consultors"},{"_id":"578db816c19cc73dbcbea75f","parentId":"578db77fc19cc73dbcbd1b4b","name":"Apostleship of the Sea"},{"_id":"578db816c19cc73dbcbea760","parentId":"578db77fc19cc73dbcbd1b4b","name":"Archdiocesan Newspaper"},{"_id":"578db816c19cc73dbcbea761","parentId":"578db77fc19cc73dbcbd1b4b","name":"Magadan Mission"},{"_id":"578db816c19cc73dbcbea762","parentId":"578db77fc19cc73dbcbd1b4b","name":"Campaign for Human Development"},{"_id":"578db816c19cc73dbcbea763","parentId":"578db77fc19cc73dbcbd1b4b","name":"Catholic Social Services"},{"_id":"578db816c19cc73dbcbea764","parentId":"578db816c19cc73dbcbea763","name":"Board Members"},{"_id":"578db816c19cc73dbcbea765","parentId":"578db77fc19cc73dbcbd1b4b","name":"Communications"},{"_id":"578db816c19cc73dbcbea766","parentId":"578db77fc19cc73dbcbd1b4b","name":"Korean Ministry"},{"_id":"578db816c19cc73dbcbea767","parentId":"578db77fc19cc73dbcbd1b4b","name":"Native Ministry"},{"_id":"578db816c19cc73dbcbea768","parentId":"578db77fc19cc73dbcbd1b4b","name":"Office of Finance"},{"_id":"578db816c19cc73dbcbea769","parentId":"578db77fc19cc73dbcbd1b4b","name":"Permanent Diaconate"},{"_id":"578db816c19cc73dbcbea76a","parentId":"578db77fc19cc73dbcbd1b4b","name":"Retreats"},{"_id":"578db816c19cc73dbcbea76b","parentId":"578db77fc19cc73dbcbd1b4b","name":"Superintendent of Schools"},{"_id":"578db816c19cc73dbcbea76c","parentId":"578db77fc19cc73dbcbd1b4b","name":"Victim Assistance Coordinator"},{"_id":"578db816c19cc73dbcbea76d","parentId":"578db77fc19cc73dbcbd1b4b","name":"Vocations"},{"_id":"578db817c19cc73dbcbea7f3","parentId":"578db77fc19cc73dbcbd1b4b","name":"Propagation of the Faith"},{"_id":"578db82cc19cc73dbcbee482","parentId":"578db82cc19cc73dbcbee4a6","name":"Marian Center, Inc."},{"_id":"578db82cc19cc73dbcbee4a6","parentId":"578db780c19cc73dbcbd1b9d","name":"Kodiak"},{"_id":"578db830c19cc73dbcbeede6","parentId":"578db783c19cc73dbcbd22ac","name":"For further details refer to the corresponding bracketed number in the Religious Institutes of Men or Women section."},{"_id":"578db83dc19cc73dbcbf14b5","parentId":"578db816c19cc73dbcbea75b","name":"Judicial Vicar"},{"_id":"578db83dc19cc73dbcbf14b6","parentId":"578db77fc19cc73dbcbd1b4b","name":"Hispanic Ministry"},{"_id":"578db83dc19cc73dbcbf14b7","parentId":"578db77fc19cc73dbcbd1b4b","name":"Ministry"},{"_id":"578db845c19cc73dbcbf2b67","parentId":"578db83dc19cc73dbcbf14b7","name":"Office of Evangelization"},{"_id":"578db848c19cc73dbcbf32a3","parentId":"578db816c19cc73dbcbea75b","name":"Judge"},{"_id":"578db84bc19cc73dbcbf3996","parentId":"578db783c19cc73dbcbd22ad","name":"Adrian Dominican Sisters, Congregation of the Most Holy Rosary"},{"_id":"578db84bc19cc73dbcbf3b4d","parentId":"578db84ec19cc73dbcbf42c7","name":"Bishop's Attic II, Inc."},{"_id":"578db84dc19cc73dbcbf413c","parentId":"578db84ec19cc73dbcbf42c6","name":"Providence Valdez Medical Center"},{"_id":"578db84ec19cc73dbcbf42c6","parentId":"578db780c19cc73dbcbd1b9b","name":"Valdez"},{"_id":"578db84ec19cc73dbcbf42c7","parentId":"578db780c19cc73dbcbd1ba0","name":"Palmer"},{"_id":"578db850c19cc73dbcbf4768","parentId":"578db77fc19cc73dbcbd1b4b","name":"Director of Catechetical Support Study Project"},{"_id":"578db850c19cc73dbcbf4797","parentId":"578db816c19cc73dbcbea757","name":"Vice Chancellor"},{"_id":"578db850c19cc73dbcbf4798","parentId":"578db77fc19cc73dbcbd1b4b","name":"Catholic Relief Services"},{"_id":"578db850c19cc73dbcbf487a","parentId":"578db783c19cc73dbcbd22ab","name":"St. Andrew Kim"},{"_id":"578db850c19cc73dbcbf487d","parentId":"578db873c19cc73dbcbfaaa0","name":"Corp. of Our Lady of the Lake Church"},{"_id":"578db852c19cc73dbcbf4e5e","parentId":"578db783c19cc73dbcbd22ac","name":"Missionary Society of St. Paul of Nigeria"},{"_id":"578db852c19cc73dbcbf4efb","parentId":"578db856c19cc73dbcbf583a","name":"Corp. of Our Lady of the Valley Catholic School, Inc."},{"_id":"578db855c19cc73dbcbf55df","parentId":"578db780c19cc73dbcbd1d1c","name":"Pastoral Team"},{"_id":"578db855c19cc73dbcbf55e0","parentId":"578db780c19cc73dbcbd1d1d","name":"Pastoral Team:"},{"_id":"578db855c19cc73dbcbf55e1","parentId":"578db780c19cc73dbcbd1d21","name":"Pastoral Team:"},{"_id":"578db856c19cc73dbcbf583a","parentId":"578db780c19cc73dbcbd1b9a","name":"Wasilla"},{"_id":"578db856c19cc73dbcbf59d2","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of the Immaculate Heart of Mary, Mother of Christ"},{"_id":"578db860c19cc73dbcbf75b0","parentId":"578db780c19cc73dbcbd1d10","name":"In Res."},{"_id":"578db860c19cc73dbcbf75b1","parentId":"578db780c19cc73dbcbd1d14","name":"In Res."},{"_id":"578db862c19cc73dbcbf7b0e","parentId":"578db801c19cc73dbcbe69ef","name":"St. Catherine of Siena CUF Chapter, Inc."},{"_id":"578db863c19cc73dbcbf7c6a","parentId":"578db816c19cc73dbcbea757","name":"Chancellor/Chief Operating Officer"},{"_id":"578db863c19cc73dbcbf7c6b","parentId":"578db77fc19cc73dbcbd1b4b","name":"Chief Operating Officer/Chancellor"},{"_id":"578db863c19cc73dbcbf7ccc","parentId":"578db77fc19cc73dbcbd1b4b","name":"Director of Seminarians"},{"_id":"578db863c19cc73dbcbf7ed7","parentId":"578db780c19cc73dbcbd1d1c","name":"St. James the Apostle"},{"_id":"578db866c19cc73dbcbf8587","parentId":"578db801c19cc73dbcbe69ef","name":"Alaska Conference of Catholic Bishops"},{"_id":"578db866c19cc73dbcbf872d","parentId":"578db77fc19cc73dbcbd1b4b","name":"Vicar for Clergy"},{"_id":"578db867c19cc73dbcbf87a8","parentId":"578db816c19cc73dbcbea763","name":"Ex Officio"},{"_id":"578db867c19cc73dbcbf87a9","parentId":"578db816c19cc73dbcbea763","name":"Emeritus Board Member"},{"_id":"578db86ac19cc73dbcbf906c","parentId":"578db77fc19cc73dbcbd1b4b","name":"Diocesan Magazine - \"Alaska Catholic\""},{"_id":"578db86ac19cc73dbcbf906d","parentId":"578db86ac19cc73dbcbf906c","name":"Publisher"},{"_id":"578db86cc19cc73dbcbf97f6","parentId":"578db783c19cc73dbcbd22ac","name":"Benedictine Monks"},{"_id":"578db870c19cc73dbcbfa251","parentId":"578db783c19cc73dbcbd22ac","name":"Congregation of the Western Mission"},{"_id":"578db870c19cc73dbcbfa287","parentId":"578db783c19cc73dbcbd22ac","name":"Vincentians"},{"_id":"578db871c19cc73dbcbfa502","parentId":"578db77fc19cc73dbcbd1b4b","name":"Director of Faith Formation"},{"_id":"578db872c19cc73dbcbfa62e","parentId":"578db816c19cc73dbcbea757","name":"Vice Chancellor for Administration"},{"_id":"578db873c19cc73dbcbfaaa0","parentId":"578db780c19cc73dbcbd1b99","name":"Big Lake, Matanuska-Susitna Borough"}];
  
	function show(nodes){
		var map = {}, node, roots = [];
			for (var i = 0; i < nodes.length; i += 1) {
				node = nodes[i];
				node.children = [];
				map[node._id] = i; // use map to look-up the parents
				if (node.parentId !== "0") {
					nodes[map[node.parentId]].children.push(node);
				} else {
					roots.push(node);
				}
			}
		return roots;
	}
console.log(show(data));
  */
  
var data =[{"_id":"578db77fc19cc73dbcbd19ed","parentId":"578db783c19cc73dbcbd22ab","name":"St. Paul Miki"},{"_id":"578db77fc19cc73dbcbd1a56","parentId":"578db783c19cc73dbcbd22ac","name":"Order of Preachers-Dominicans"},{"_id":"578db77fc19cc73dbcbd1a57","parentId":"578db783c19cc73dbcbd22ac","name":"Marist Fathers"},{"_id":"578db77fc19cc73dbcbd1a58","parentId":"578db783c19cc73dbcbd22ac","name":"Oblates of Mary Immaculate"},{"_id":"578db77fc19cc73dbcbd1a9b","parentId":"578db783c19cc73dbcbd22ad","name":"School Sisters of St. Francis"},{"_id":"578db77fc19cc73dbcbd1a9c","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of the Holy Family"},{"_id":"578db77fc19cc73dbcbd1a9d","parentId":"578db783c19cc73dbcbd22ad","name":"Little Sisters of Jesus"},{"_id":"578db77fc19cc73dbcbd1a9e","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of Mercy of the Americas"},{"_id":"578db77fc19cc73dbcbd1a9f","parentId":"578db783c19cc73dbcbd22ad","name":"Nuns of Perpetual Adoration of the Blessed Sacrament"},{"_id":"578db77fc19cc73dbcbd1aa0","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of the Most Precious Blood"},{"_id":"578db77fc19cc73dbcbd1aa1","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of St. Joseph of Peace"},{"_id":"578db77fc19cc73dbcbd1aa2","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of Mercy of the Americas"},{"_id":"578db77fc19cc73dbcbd1aa3","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of St. Paul de Chartres"},{"_id":"578db77fc19cc73dbcbd1aa4","parentId":"578db783c19cc73dbcbd22ad","name":"Daughters of Charity of St. Vincent DePaul"},{"_id":"578db77fc19cc73dbcbd1ad0","parentId":"578db801c19cc73dbcbe69e6","name":"St. Elizabeth Ann Seton School"},{"_id":"578db77fc19cc73dbcbd1af2","parentId":"578db801c19cc73dbcbe69e7","name":"St. Mary's"},{"_id":"578db77fc19cc73dbcbd1b26","parentId":"578db801c19cc73dbcbe69e6","name":"Lumen Christi High School"},{"_id":"578db77fc19cc73dbcbd1b2e","parentId":"578db801c19cc73dbcbe69e6","name":"Holy Rosary Academy"},{"_id":"578db77fc19cc73dbcbd1b3f","parentId":"578db77ec19cc73dbcbd1970","name":"Masthead"},{"_id":"578db77fc19cc73dbcbd1b45","parentId":"578db77ec19cc73dbcbd1970","name":"Statistics"},{"_id":"578db77fc19cc73dbcbd1b4b","parentId":"578db77ec19cc73dbcbd1970","name":"Curia"},{"_id":"578db77fc19cc73dbcbd1b51","parentId":"578db77ec19cc73dbcbd1970","name":"Clergy, Parish, Missions"},{"_id":"578db77fc19cc73dbcbd1b57","parentId":"578db77ec19cc73dbcbd1970","name":"Chaplains of Public Institutions"},{"_id":"578db77fc19cc73dbcbd1b5d","parentId":"578db77ec19cc73dbcbd1970","name":"Institutions Located in Diocese"},{"_id":"578db780c19cc73dbcbd1b99","parentId":"578db77fc19cc73dbcbd1b51","name":"OUTSIDE THE CITY OF ANCHORAGE"},{"_id":"578db780c19cc73dbcbd1b9a","parentId":"578db77fc19cc73dbcbd1b5d","name":"[A] GRADE SCHOOLS, HIGH SCHOOLS  PAROCHIAL"},{"_id":"578db780c19cc73dbcbd1b9b","parentId":"578db77fc19cc73dbcbd1b5d","name":"[B] GENERAL HOSPITALS"},{"_id":"578db780c19cc73dbcbd1b9c","parentId":"578db77fc19cc73dbcbd1b5d","name":"[C] NURSING HOMES"},{"_id":"578db780c19cc73dbcbd1b9d","parentId":"578db77fc19cc73dbcbd1b5d","name":"[D] CATHOLIC SOCIAL SERVICES"},{"_id":"578db780c19cc73dbcbd1b9e","parentId":"578db77fc19cc73dbcbd1b5d","name":"[E] CONVENTS AND RESIDENCES FOR SISTERS"},{"_id":"578db780c19cc73dbcbd1b9f","parentId":"578db77fc19cc73dbcbd1b5d","name":"[F] RETREAT HOUSES"},{"_id":"578db780c19cc73dbcbd1ba0","parentId":"578db77fc19cc73dbcbd1b5d","name":"[G] MISCELLANEOUS"},{"_id":"578db780c19cc73dbcbd1c45","parentId":"578db801c19cc73dbcbe69ef","name":"Providence Health System Housing"},{"_id":"578db780c19cc73dbcbd1c46","parentId":"578db801c19cc73dbcbe69ef","name":"Providence Home Health Care, Anchorage, Alaska"},{"_id":"578db780c19cc73dbcbd1d10","parentId":"578db783c19cc73dbcbd22ab","name":"Holy Family Cathedral"},{"_id":"578db780c19cc73dbcbd1d11","parentId":"578db783c19cc73dbcbd22ab","name":"St. Anthony"},{"_id":"578db780c19cc73dbcbd1d12","parentId":"578db783c19cc73dbcbd22ab","name":"St. Benedict"},{"_id":"578db780c19cc73dbcbd1d13","parentId":"578db783c19cc73dbcbd22ab","name":"St. Elizabeth Ann Seton"},{"_id":"578db780c19cc73dbcbd1d14","parentId":"578db783c19cc73dbcbd22ab","name":"Holy Cross"},{"_id":"578db780c19cc73dbcbd1d15","parentId":"578db783c19cc73dbcbd22ab","name":"Our Lady of Guadalupe Co Cathedral"},{"_id":"578db780c19cc73dbcbd1d16","parentId":"578db783c19cc73dbcbd22ab","name":"St. Patrick"},{"_id":"578db780c19cc73dbcbd1d17","parentId":"578db801c19cc73dbcbe69d9","name":"St. Joseph"},{"_id":"578db780c19cc73dbcbd1d18","parentId":"578db801c19cc73dbcbe69da","name":"Holy Rosary"},{"_id":"578db780c19cc73dbcbd1d19","parentId":"578db783c19cc73dbcbd22ab","name":"Corp. of St. Christopher By the Sea Church"},{"_id":"578db780c19cc73dbcbd1d1a","parentId":"578db801c19cc73dbcbe69db","name":"St. Andrew"},{"_id":"578db780c19cc73dbcbd1d1b","parentId":"578db801c19cc73dbcbe69dc","name":"Holy Family"},{"_id":"578db780c19cc73dbcbd1d1c","parentId":"578db801c19cc73dbcbe69dd","name":"St. John the Baptist"},{"_id":"578db780c19cc73dbcbd1d1d","parentId":"578db801c19cc73dbcbe69de","name":"Our Lady of the Angels"},{"_id":"578db780c19cc73dbcbd1d1e","parentId":"578db801c19cc73dbcbe69df","name":"St. Mary's"},{"_id":"578db780c19cc73dbcbd1d1f","parentId":"578db801c19cc73dbcbe69e0","name":"St. Michael"},{"_id":"578db780c19cc73dbcbd1d20","parentId":"578db801c19cc73dbcbe69e1","name":"Sacred Heart"},{"_id":"578db780c19cc73dbcbd1d21","parentId":"578db801c19cc73dbcbe69e2","name":"Our Lady of Perpetual Help"},{"_id":"578db780c19cc73dbcbd1d22","parentId":"578db801c19cc73dbcbe69e3","name":"St. Bernard"},{"_id":"578db780c19cc73dbcbd1d23","parentId":"578db801c19cc73dbcbe69e4","name":"St. Francis Xavier"},{"_id":"578db780c19cc73dbcbd1d24","parentId":"578db801c19cc73dbcbe69e5","name":"Sacred Heart"},{"_id":"578db782c19cc73dbcbd2081","parentId":"578db780c19cc73dbcbd1d13","name":"Our Lady of the Snows"},{"_id":"578db782c19cc73dbcbd2082","parentId":"578db780c19cc73dbcbd1d18","name":"St. Theresa"},{"_id":"578db782c19cc73dbcbd2083","parentId":"578db780c19cc73dbcbd1d1c","name":"St. Peter the Apostle"},{"_id":"578db782c19cc73dbcbd2084","parentId":"578db780c19cc73dbcbd1d20","name":"St. John Neumann Church"},{"_id":"578db782c19cc73dbcbd2085","parentId":"578db780c19cc73dbcbd1d22","name":"St. Philip Benizi"},{"_id":"578db782c19cc73dbcbd2086","parentId":"578db850c19cc73dbcbf487d","name":"St. Christopher"},{"_id":"578db782c19cc73dbcbd2194","parentId":"578db77fc19cc73dbcbd1b57","name":"On Duty Outside Archdiocese"},{"_id":"578db783c19cc73dbcbd21ab","parentId":"578db77fc19cc73dbcbd1b57","name":"Retired"},{"_id":"578db783c19cc73dbcbd21b1","parentId":"578db77fc19cc73dbcbd1b57","name":"Permanent Deacons"},{"_id":"578db783c19cc73dbcbd21d0","parentId":"578db801c19cc73dbcbe69e8","name":"Providence Alaska Medical Center"},{"_id":"578db783c19cc73dbcbd21d1","parentId":"578db801c19cc73dbcbe69ea","name":"Providence Seward Medical Center"},{"_id":"578db783c19cc73dbcbd21d2","parentId":"578db801c19cc73dbcbe69e9","name":"Providence Kodiak Island Medical Center"},{"_id":"578db783c19cc73dbcbd21df","parentId":"578db801c19cc73dbcbe69ec","name":"Brother Francis Shelter"},{"_id":"578db783c19cc73dbcbd21e0","parentId":"578db801c19cc73dbcbe69ef","name":"Covenant House Alaska"},{"_id":"578db783c19cc73dbcbd2220","parentId":"578db801c19cc73dbcbe69ed","name":"Daughters of Charity"},{"_id":"578db783c19cc73dbcbd2221","parentId":"578db801c19cc73dbcbe69ed","name":"Sisters of Perpetual Adoration"},{"_id":"578db783c19cc73dbcbd2222","parentId":"578db801c19cc73dbcbe69ed","name":"Sisters of St. Paul de Chartres"},{"_id":"578db783c19cc73dbcbd2259","parentId":"578db801c19cc73dbcbe69eb","name":"Providence Extended Care Center"},{"_id":"578db783c19cc73dbcbd2282","parentId":"578db801c19cc73dbcbe69ec","name":"Catholic Social Services Center"},{"_id":"578db783c19cc73dbcbd2283","parentId":"578db783c19cc73dbcbd2282","name":"Catholic Social Services Center"},{"_id":"578db783c19cc73dbcbd2284","parentId":"578db801c19cc73dbcbe69ec","name":"Clare House"},{"_id":"578db783c19cc73dbcbd2285","parentId":"578db801c19cc73dbcbe69ec","name":"McAuley Manor"},{"_id":"578db783c19cc73dbcbd2286","parentId":"578db801c19cc73dbcbe69ec","name":"Charlie Elder House"},{"_id":"578db783c19cc73dbcbd2299","parentId":"578db801c19cc73dbcbe69ee","name":"Holy Spirit Center"},{"_id":"578db783c19cc73dbcbd229a","parentId":"578db801c19cc73dbcbe69ef","name":"Catholic Retreat House Ministries, Inc."},{"_id":"578db783c19cc73dbcbd22a0","parentId":"578db77fc19cc73dbcbd1b5d","name":"NECROLOGY"},{"_id":"578db783c19cc73dbcbd22ab","parentId":"578db77fc19cc73dbcbd1b51","name":"CITY OF ANCHORAGE"},{"_id":"578db783c19cc73dbcbd22ac","parentId":"578db77fc19cc73dbcbd1b5d","name":"RELIGIOUS INSTITUTES OF MEN REPRESENTED IN THE ARCHDIOCESE"},{"_id":"578db783c19cc73dbcbd22ad","parentId":"578db77fc19cc73dbcbd1b5d","name":"RELIGIOUS INSTITUTES OF WOMEN REPRESENTED IN THE ARCHDIOCESE"},{"_id":"578db783c19cc73dbcbd22e9","parentId":"578db801c19cc73dbcbe69ef","name":"Catholic Foundation of Alaska"},{"_id":"578db783c19cc73dbcbd22ea","parentId":"578db801c19cc73dbcbe69ef","name":"Archdiocese of Anchorage Priests Pension Trust"},{"_id":"578db783c19cc73dbcbd22eb","parentId":"578db801c19cc73dbcbe69ef","name":"Providence Alaska Foundation, Anchorage, Alaska"},{"_id":"578db801c19cc73dbcbe69d9","parentId":"578db780c19cc73dbcbd1b99","name":"Cordova, Valdez-Cordova Co."},{"_id":"578db801c19cc73dbcbe69da","parentId":"578db780c19cc73dbcbd1b99","name":"Dillingham, Dillingham Co."},{"_id":"578db801c19cc73dbcbe69db","parentId":"578db780c19cc73dbcbd1b99","name":"Eagle River, Anchorage Borough"},{"_id":"578db801c19cc73dbcbe69dc","parentId":"578db780c19cc73dbcbd1b99","name":"Glennallen, Valdez-Cordova Co."},{"_id":"578db801c19cc73dbcbe69dd","parentId":"578db780c19cc73dbcbd1b99","name":"Homer, Kenai Peninsula Borough"},{"_id":"578db801c19cc73dbcbe69de","parentId":"578db780c19cc73dbcbd1b99","name":"Kenai, Kenai Peninsula Borough"},{"_id":"578db801c19cc73dbcbe69df","parentId":"578db780c19cc73dbcbd1b99","name":"Kodiak, Kodiak Island Borough"},{"_id":"578db801c19cc73dbcbe69e0","parentId":"578db780c19cc73dbcbd1b99","name":"Palmer, Matanuska-Susitna Borough"},{"_id":"578db801c19cc73dbcbe69e1","parentId":"578db780c19cc73dbcbd1b99","name":"Seward, Kenai Peninsula Borough"},{"_id":"578db801c19cc73dbcbe69e2","parentId":"578db780c19cc73dbcbd1b99","name":"Soldotna, Kenai Peninsula Borough"},{"_id":"578db801c19cc73dbcbe69e3","parentId":"578db780c19cc73dbcbd1b99","name":"Talkeetna, Matanuska-Susitna Borough"},{"_id":"578db801c19cc73dbcbe69e4","parentId":"578db780c19cc73dbcbd1b99","name":"Valdez, Valdez-Cordova Co."},{"_id":"578db801c19cc73dbcbe69e5","parentId":"578db780c19cc73dbcbd1b99","name":"Wasilla, Matanuska-Susitna Borough"},{"_id":"578db801c19cc73dbcbe69e6","parentId":"578db780c19cc73dbcbd1b9a","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69e7","parentId":"578db780c19cc73dbcbd1b9a","name":"Kodiak"},{"_id":"578db801c19cc73dbcbe69e8","parentId":"578db780c19cc73dbcbd1b9b","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69e9","parentId":"578db780c19cc73dbcbd1b9b","name":"Kodiak"},{"_id":"578db801c19cc73dbcbe69ea","parentId":"578db780c19cc73dbcbd1b9b","name":"Seward"},{"_id":"578db801c19cc73dbcbe69eb","parentId":"578db780c19cc73dbcbd1b9c","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69ec","parentId":"578db780c19cc73dbcbd1b9d","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69ed","parentId":"578db780c19cc73dbcbd1b9e","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69ee","parentId":"578db780c19cc73dbcbd1b9f","name":"Anchorage"},{"_id":"578db801c19cc73dbcbe69ef","parentId":"578db780c19cc73dbcbd1ba0","name":"Anchorage"},{"_id":"578db816c19cc73dbcbea659","parentId":"578db77fc19cc73dbcbd1b4b","name":"Archdiocesan Offices and Directors"},{"_id":"578db816c19cc73dbcbea755","parentId":"578db77fc19cc73dbcbd1b4b","name":"Former Archbishops"},{"_id":"578db816c19cc73dbcbea756","parentId":"578db77fc19cc73dbcbd1b4b","name":"Vicar General"},{"_id":"578db816c19cc73dbcbea757","parentId":"578db77fc19cc73dbcbd1b4b","name":"Pastoral Center"},{"_id":"578db816c19cc73dbcbea758","parentId":"578db77fc19cc73dbcbd1b4b","name":"Secretary to Archbishop Emeritus"},{"_id":"578db816c19cc73dbcbea759","parentId":"578db77fc19cc73dbcbd1b4b","name":"Secretary to Archbishop Roger L. Schwietz, O.M.I."},{"_id":"578db816c19cc73dbcbea75a","parentId":"578db77fc19cc73dbcbd1b4b","name":"Stewardship/Development Office"},{"_id":"578db816c19cc73dbcbea75b","parentId":"578db77fc19cc73dbcbd1b4b","name":"Tribunal"},{"_id":"578db816c19cc73dbcbea75c","parentId":"578db816c19cc73dbcbea75b","name":"Defender of the Bond"},{"_id":"578db816c19cc73dbcbea75d","parentId":"578db816c19cc73dbcbea75b","name":"Notaries"},{"_id":"578db816c19cc73dbcbea75e","parentId":"578db77fc19cc73dbcbd1b4b","name":"Diocesan Consultors"},{"_id":"578db816c19cc73dbcbea75f","parentId":"578db77fc19cc73dbcbd1b4b","name":"Apostleship of the Sea"},{"_id":"578db816c19cc73dbcbea760","parentId":"578db77fc19cc73dbcbd1b4b","name":"Archdiocesan Newspaper"},{"_id":"578db816c19cc73dbcbea761","parentId":"578db77fc19cc73dbcbd1b4b","name":"Magadan Mission"},{"_id":"578db816c19cc73dbcbea762","parentId":"578db77fc19cc73dbcbd1b4b","name":"Campaign for Human Development"},{"_id":"578db816c19cc73dbcbea763","parentId":"578db77fc19cc73dbcbd1b4b","name":"Catholic Social Services"},{"_id":"578db816c19cc73dbcbea764","parentId":"578db816c19cc73dbcbea763","name":"Board Members"},{"_id":"578db816c19cc73dbcbea765","parentId":"578db77fc19cc73dbcbd1b4b","name":"Communications"},{"_id":"578db816c19cc73dbcbea766","parentId":"578db77fc19cc73dbcbd1b4b","name":"Korean Ministry"},{"_id":"578db816c19cc73dbcbea767","parentId":"578db77fc19cc73dbcbd1b4b","name":"Native Ministry"},{"_id":"578db816c19cc73dbcbea768","parentId":"578db77fc19cc73dbcbd1b4b","name":"Office of Finance"},{"_id":"578db816c19cc73dbcbea769","parentId":"578db77fc19cc73dbcbd1b4b","name":"Permanent Diaconate"},{"_id":"578db816c19cc73dbcbea76a","parentId":"578db77fc19cc73dbcbd1b4b","name":"Retreats"},{"_id":"578db816c19cc73dbcbea76b","parentId":"578db77fc19cc73dbcbd1b4b","name":"Superintendent of Schools"},{"_id":"578db816c19cc73dbcbea76c","parentId":"578db77fc19cc73dbcbd1b4b","name":"Victim Assistance Coordinator"},{"_id":"578db816c19cc73dbcbea76d","parentId":"578db77fc19cc73dbcbd1b4b","name":"Vocations"},{"_id":"578db817c19cc73dbcbea7f3","parentId":"578db77fc19cc73dbcbd1b4b","name":"Propagation of the Faith"},{"_id":"578db82cc19cc73dbcbee482","parentId":"578db82cc19cc73dbcbee4a6","name":"Marian Center, Inc."},{"_id":"578db82cc19cc73dbcbee4a6","parentId":"578db780c19cc73dbcbd1b9d","name":"Kodiak"},{"_id":"578db830c19cc73dbcbeede6","parentId":"578db783c19cc73dbcbd22ac","name":"For further details refer to the corresponding bracketed number in the Religious Institutes of Men or Women section."},{"_id":"578db83dc19cc73dbcbf14b5","parentId":"578db816c19cc73dbcbea75b","name":"Judicial Vicar"},{"_id":"578db83dc19cc73dbcbf14b6","parentId":"578db77fc19cc73dbcbd1b4b","name":"Hispanic Ministry"},{"_id":"578db83dc19cc73dbcbf14b7","parentId":"578db77fc19cc73dbcbd1b4b","name":"Ministry"},{"_id":"578db845c19cc73dbcbf2b67","parentId":"578db83dc19cc73dbcbf14b7","name":"Office of Evangelization"},{"_id":"578db848c19cc73dbcbf32a3","parentId":"578db816c19cc73dbcbea75b","name":"Judge"},{"_id":"578db84bc19cc73dbcbf3996","parentId":"578db783c19cc73dbcbd22ad","name":"Adrian Dominican Sisters, Congregation of the Most Holy Rosary"},{"_id":"578db84bc19cc73dbcbf3b4d","parentId":"578db84ec19cc73dbcbf42c7","name":"Bishop's Attic II, Inc."},{"_id":"578db84dc19cc73dbcbf413c","parentId":"578db84ec19cc73dbcbf42c6","name":"Providence Valdez Medical Center"},{"_id":"578db84ec19cc73dbcbf42c6","parentId":"578db780c19cc73dbcbd1b9b","name":"Valdez"},{"_id":"578db84ec19cc73dbcbf42c7","parentId":"578db780c19cc73dbcbd1ba0","name":"Palmer"},{"_id":"578db850c19cc73dbcbf4768","parentId":"578db77fc19cc73dbcbd1b4b","name":"Director of Catechetical Support Study Project"},{"_id":"578db850c19cc73dbcbf4797","parentId":"578db816c19cc73dbcbea757","name":"Vice Chancellor"},{"_id":"578db850c19cc73dbcbf4798","parentId":"578db77fc19cc73dbcbd1b4b","name":"Catholic Relief Services"},{"_id":"578db850c19cc73dbcbf487a","parentId":"578db783c19cc73dbcbd22ab","name":"St. Andrew Kim"},{"_id":"578db850c19cc73dbcbf487d","parentId":"578db873c19cc73dbcbfaaa0","name":"Corp. of Our Lady of the Lake Church"},{"_id":"578db852c19cc73dbcbf4e5e","parentId":"578db783c19cc73dbcbd22ac","name":"Missionary Society of St. Paul of Nigeria"},{"_id":"578db852c19cc73dbcbf4efb","parentId":"578db856c19cc73dbcbf583a","name":"Corp. of Our Lady of the Valley Catholic School, Inc."},{"_id":"578db855c19cc73dbcbf55df","parentId":"578db780c19cc73dbcbd1d1c","name":"Pastoral Team"},{"_id":"578db855c19cc73dbcbf55e0","parentId":"578db780c19cc73dbcbd1d1d","name":"Pastoral Team:"},{"_id":"578db855c19cc73dbcbf55e1","parentId":"578db780c19cc73dbcbd1d21","name":"Pastoral Team:"},{"_id":"578db856c19cc73dbcbf583a","parentId":"578db780c19cc73dbcbd1b9a","name":"Wasilla"},{"_id":"578db856c19cc73dbcbf59d2","parentId":"578db783c19cc73dbcbd22ad","name":"Sisters of the Immaculate Heart of Mary, Mother of Christ"},{"_id":"578db860c19cc73dbcbf75b0","parentId":"578db780c19cc73dbcbd1d10","name":"In Res."},{"_id":"578db860c19cc73dbcbf75b1","parentId":"578db780c19cc73dbcbd1d14","name":"In Res."},{"_id":"578db862c19cc73dbcbf7b0e","parentId":"578db801c19cc73dbcbe69ef","name":"St. Catherine of Siena CUF Chapter, Inc."},{"_id":"578db863c19cc73dbcbf7c6a","parentId":"578db816c19cc73dbcbea757","name":"Chancellor/Chief Operating Officer"},{"_id":"578db863c19cc73dbcbf7c6b","parentId":"578db77fc19cc73dbcbd1b4b","name":"Chief Operating Officer/Chancellor"},{"_id":"578db863c19cc73dbcbf7ccc","parentId":"578db77fc19cc73dbcbd1b4b","name":"Director of Seminarians"},{"_id":"578db863c19cc73dbcbf7ed7","parentId":"578db780c19cc73dbcbd1d1c","name":"St. James the Apostle"},{"_id":"578db866c19cc73dbcbf8587","parentId":"578db801c19cc73dbcbe69ef","name":"Alaska Conference of Catholic Bishops"},{"_id":"578db866c19cc73dbcbf872d","parentId":"578db77fc19cc73dbcbd1b4b","name":"Vicar for Clergy"},{"_id":"578db867c19cc73dbcbf87a8","parentId":"578db816c19cc73dbcbea763","name":"Ex Officio"},{"_id":"578db867c19cc73dbcbf87a9","parentId":"578db816c19cc73dbcbea763","name":"Emeritus Board Member"},{"_id":"578db86ac19cc73dbcbf906c","parentId":"578db77fc19cc73dbcbd1b4b","name":"Diocesan Magazine - \"Alaska Catholic\""},{"_id":"578db86ac19cc73dbcbf906d","parentId":"578db86ac19cc73dbcbf906c","name":"Publisher"},{"_id":"578db86cc19cc73dbcbf97f6","parentId":"578db783c19cc73dbcbd22ac","name":"Benedictine Monks"},{"_id":"578db870c19cc73dbcbfa251","parentId":"578db783c19cc73dbcbd22ac","name":"Congregation of the Western Mission"},{"_id":"578db870c19cc73dbcbfa287","parentId":"578db783c19cc73dbcbd22ac","name":"Vincentians"},{"_id":"578db871c19cc73dbcbfa502","parentId":"578db77fc19cc73dbcbd1b4b","name":"Director of Faith Formation"},{"_id":"578db872c19cc73dbcbfa62e","parentId":"578db816c19cc73dbcbea757","name":"Vice Chancellor for Administration"},{"_id":"578db873c19cc73dbcbfaaa0","parentId":"578db780c19cc73dbcbd1b99","name":"Big Lake, Matanuska-Susitna Borough"}];
data=data.map(function(d){ d.id=d._id; return d;});

function unflatten(nodes){
nodes=nodes.map(function(d){ d.id=d._id; return d;});
var map = {}, _node, roots = [];
for (var i = 0; i < nodes.length; i += 1) {
    _node = nodes[i];
    _node.children = [];
    map[_node.id] = i; // use map to look-up the parents
    if (_node.parentId !== "578db77ec19cc73dbcbd1970") {
	_node.children = [];
        nodes[map[_node.parentId]].children.push(_node);
    } else {
        roots.push(_node);
    }
}
	return roots;
}
console.log(unflatten(data));